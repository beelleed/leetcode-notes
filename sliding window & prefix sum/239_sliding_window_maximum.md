# ğŸ“Š LeetCode 239 â€“ Sliding Window Maximum
ğŸ”— é¡Œç›®é€£çµ | Problem Link: [https://leetcode.com/problems/sliding-window-maximum/](https://leetcode.com/problems/sliding-window-maximum/)

---

## ğŸ“„ é¡Œç›®èªªæ˜ | Problem Description

- **ä¸­æ–‡**ï¼šçµ¦å®šæ•´æ•¸é™£åˆ— `nums` å’Œä¸€å€‹æ»‘å‹•è¦–çª—å¤§å° `k`ï¼Œé€™å€‹è¦–çª—å¾é™£åˆ—æœ€å·¦é‚Šç§»å‹•åˆ°æœ€å³é‚Šï¼Œæ¯æ¬¡ç§»å‹•ä¸€æ­¥ã€‚æ¯å€‹è¦–çª—çš„ç•¶ä¸‹åŒ…å« `k` å€‹å…ƒç´ ï¼Œæ±‚æ¯ä¸€å€‹è¦–çª—çš„æœ€å¤§å€¼ï¼Œå›å‚³é€™äº›æœ€å¤§å€¼çµ„æˆçš„é™£åˆ—ã€‚  
- **English**: Given an integer array `nums` and a window size `k`, there is a sliding window which moves from the very left of the array to the very right. You can only see the `k` numbers inside the window at any time. Each time the window moves right by one, return the maximum value in the current window. Produce an array of these maximums.

- **Examples**:
    - Example 1:

        - Input: nums = [1,3,-1,-3,5,3,6,7], k = 3
        - Output: [3,3,5,5,6,7]
        - Explanation: 
        ```markdown
        Window position                Max
        ---------------               -----
        [1  3  -1] -3  5  3  6  7       3
        1 [3  -1  -3] 5  3  6  7       3
        1  3 [-1  -3  5] 3  6  7       5
        1  3  -1 [-3  5  3] 6  7       5
        1  3  -1  -3 [5  3  6] 7       6
        1  3  -1  -3  5 [3  6  7]      7
        ```

    - Example 2:

        - Input: nums = [1], k = 1
        - Output: [1]

---

## ğŸ§  è§£é¡Œæ€è·¯ | Solution Ideas

æœ‰å¹¾ç¨®æ–¹æ³•å¯ä»¥åšé€™é¡Œï¼š

### æ–¹æ³•ä¸€ï¼šBruteâ€‘Forceï¼ˆæš´åŠ›æ³•ï¼‰

- æ»‘å‹•è¦–çª—æ¯ç§»å‹•ä¸€æ­¥å°±æª¢æŸ¥è©² window è£¡æ‰€æœ‰ `k` å€‹å…ƒç´ ï¼Œæ‰¾å‡ºæœ€å¤§å€¼ã€‚  
- æ™‚é–“è¤‡é›œåº¦æ˜¯ `O(n * k)`ï¼Œn = `nums.length`ã€‚ç•¶ `n` å’Œ `k` éƒ½å¤§æ™‚æœƒå¤ªæ…¢ã€‚

### æ–¹æ³•äºŒï¼šä½¿ç”¨ Priority Queueï¼ˆæœ€å¤§å † / å † + ç´¢å¼•ï¼‰

- ç”¨ maxâ€‘heapï¼ˆæˆ– Python èˆ‡ `heapq` çµåˆè² å€¼ trickï¼å„²å€¼ï¼‹ç´¢å¼•ï¼‰ä¾†ç¶­æŒç•¶å‰è¦–çª—å…ƒç´ ã€‚  
- ç•¶æ»‘çª—ç§»å‹•æ™‚ï¼ŒæŠŠæ–°å…ƒç´ åŠ å…¥ heapï¼ŒåŒæ™‚æŠŠéæœŸï¼ˆé›¢é–‹è¦–çª—ç¯„åœï¼‰çš„å…ƒç´ å¾ heap ä¸­å½ˆæ‰ã€‚  
- å°æ¯å€‹è¦–çª—ä½ç½®ï¼Œheap çš„é ‚ç«¯æ˜¯æœ€å¤§å€¼ã€‚  
- æ™‚é–“è¤‡é›œåº¦ç´„ `O(n log k)`ã€‚

### æ–¹æ³•ä¸‰ï¼ˆæœ€ä½³ï¼‰ï¼šä½¿ç”¨ Monotonic Dequeï¼ˆå–®èª¿é›™ç«¯ä½‡åˆ—ï¼‰

- ç”¨ä¸€å€‹é›™ç«¯ä½‡åˆ—å­˜å„²ã€Œå¯èƒ½æˆç‚ºçª—å£ä¸­æœ€å¤§å€¼çš„å…ƒç´ ç´¢å¼•ã€ï¼Œä¸¦ç¶­æŒå…¶å…§éƒ¨å°æ‡‰å€¼æ˜¯**å¾å¤§åˆ°å°æ’åˆ—**ï¼ˆå¾å‰ç«¯åˆ°å¾Œç«¯ï¼‰ã€‚  
- æ¯æ¬¡æ»‘å‹•çª—å£ï¼ŒåŠ ä¸€å€‹æ–°å…ƒç´ ï¼šå¾ deque å¾Œç«¯å»æ‰æ‰€æœ‰æ¯”æ–°å…ƒç´ å°çš„å…ƒç´ ï¼ˆå› ç‚ºé€™äº›å°çš„å…ƒç´ ä¸å¯èƒ½åœ¨å¾€å¾Œ window ä¸­æˆç‚ºæœ€å¤§å€¼ï¼‰ã€‚  
- ç•¶è¦–çª—å·¦é‚Šç§»å‡ºä¸€å€‹å…ƒç´ æ™‚ï¼Œå¦‚æœè©²å…ƒç´ çš„ç´¢å¼•æ­£æ˜¯ deque çš„å‰ç«¯ï¼Œå°±æŠŠå®ƒ `popleft()`ã€‚  
- ç•¶è¦–çª—å·²ç¶“æ»¿ `k` å¤§å°æ™‚ï¼ŒæŠŠ deque çš„å‰ç«¯ï¼ˆæœ€å¤§å€¼ï¼‰æ”¾å…¥çµæœé™£åˆ—ã€‚  
- æ™‚é–“è¤‡é›œåº¦ `O(n)`ï¼Œç©ºé–“è¤‡é›œåº¦ `O(k)`ã€‚

---

## ğŸ’» æœ€å„ªæ–¹æ¡ˆç¨‹å¼ç¢¼ï¼ˆPython + Dequeï¼‰

```python
from collections import deque
from typing import List

class Solution:
    def maxSlidingWindow(self, nums: List[int], k: int) -> List[int]:
        dq = deque()  # å­˜æ”¾ **ç´¢å¼•**ï¼Œå°æ‡‰ nums çš„å€¼æœƒå–®èª¿éæ¸›
        res = []
        for i, num in enumerate(nums):
            # ç§»é™¤ deque å‰ç«¯ä¸­å·²ç¶“é›¢é–‹ window çš„ç´¢å¼•
            if dq and dq[0] < i - k + 1:
                dq.popleft()

            # ç§»é™¤ deque å¾Œç«¯æ‰€æœ‰å°æ‡‰å€¼æ¯” nums[i] å°çš„ç´¢å¼•
            while dq and nums[dq[-1]] < num:
                dq.pop()

            # æŠŠç•¶å‰ç´¢å¼•åŠ å…¥ deque
            dq.append(i)

            # åªæœ‰ç•¶ i >= k - 1ï¼Œwindow å®Œæ•´æ™‚æ‰è¨˜éŒ„æœ€å¤§å€¼
            if i >= k - 1:
                res.append(nums[dq[0]])

        return res
```
```python
from collections import deque
from typing import List

class Solution:
    def maxSlidingWindow(self, nums: List[int], k: int) -> List[int]:
        dq = deque()  # å­˜æ”¾ **ç´¢å¼•**ï¼Œå°æ‡‰ nums çš„å€¼æœƒå–®èª¿éæ¸›
        res = []
```
- ç”¨ deque (é›™ç«¯ä½‡åˆ—) å­˜æ”¾ã€Œç´¢å¼•ã€è€Œä¸æ˜¯å­˜æ”¾å€¼ã€‚

- dq ç”¨ä¾†ç¶­æŒä¸€æ¢ã€Œå¯èƒ½ç‚ºçª—å£æœ€å¤§å€¼å€™é¸ã€çš„ç´¢å¼•éšŠåˆ—ï¼Œå…¶å°æ‡‰çš„ nums å€¼å¾å‰åˆ°å¾Œæ˜¯å–®èª¿éæ¸›ï¼ˆå¤§ â†’ å° â†’ â€¦ï¼‰ã€‚

- res ç”¨ä¾†å„²å­˜æ¯å€‹æ»¿çª—å£çš„æœ€å¤§å€¼ã€‚
```python
for i, num in enumerate(nums):
```
- ç”¨ i æ˜¯ç›®å‰éæ­·åˆ°çš„ç´¢å¼•ï¼Œnum = nums[i] æ˜¯ç•¶å‰å€¼ã€‚
```python
if dq and dq[0] < i - k + 1:
    dq.popleft()
```
- ç•¶çª—å£å¾å·¦é‚Šæ»‘å‹•æ™‚ï¼ŒæŸäº›ç´¢å¼•æœƒè®Šå¾—ä¸å†å±¬æ–¼ç•¶å‰çª—å£ï¼ˆéæœŸï¼‰ã€‚

- ç•¶ dq[0]ï¼ˆéšŠé¦–ï¼‰ç´¢å¼•å°æ–¼ i - k + 1ï¼Œæ„å‘³å®ƒå·²ç¶“ä¸åœ¨ç•¶å‰çª—å£å…§ï¼Œæ‡‰è©²è¢«ç§»é™¤ã€‚
```python
while dq and nums[dq[-1]] < num:
    dq.pop()
```
- æ–°é€²çš„å…ƒç´  num å¦‚æœæ¯”ç¾æœ‰éšŠåˆ—åœ¨å°¾ç«¯çš„é‚£äº›å…ƒç´ å€¼å¤§ï¼Œé‚£äº›å°çš„å…ƒç´ ä¸å¯èƒ½åœ¨ä»¥å¾Œçš„çª—å£ä¸­æˆç‚ºæœ€å¤§å€¼ï¼ˆå› ç‚º num ä¸€æ—¦é€²ä¾†ï¼Œå®ƒæœƒæ¯”å®ƒå€‘å¾Œé¢è¼ƒæ—©å¤±æ•ˆæˆ–è¢«æ“ å‡ºçª—å£æ™‚é‚„å¤§ï¼‰ã€‚

- æ‰€ä»¥æŠŠé€™äº›å°çš„å€¼å°æ‡‰çš„ç´¢å¼•å¾å°¾ç«¯ pop å‡ºå»ã€‚
```python
dq.append(i)
```
- æŠŠç›®å‰ç´¢å¼• i æ¨é€²éšŠå°¾ã€‚
```python
if i >= k - 1:
    res.append(nums[dq[0]])
```
- ç•¶ i >= k - 1 æ™‚ï¼Œè¡¨ç¤ºå¾ç¬¬ i - k + 1 åˆ° i çš„é‚£å€‹çª—å£æ˜¯ç¬¬ä¸€å€‹ã€Œå®Œæ•´ã€çª—å£ã€‚

- æ­¤æ™‚ï¼ŒéšŠé¦– dq[0] å°æ‡‰çš„ nums[dq[0]] æ˜¯ç•¶å‰çª—å£å…§æœ€å¤§çš„å…ƒç´ ï¼Œå› ç‚ºéšŠåˆ—æ˜¯å–®èª¿éæ¸›çš„ï¼Œæ‰€ä»¥å‰ç«¯æ°¸é æ˜¯æœ€å¤§å€¼ã€‚
```python
return res
```
- å›å‚³æ‰€æœ‰çª—å£çš„æœ€å¤§å€¼é™£åˆ—ã€‚

---

## ğŸ§ª å¯¦ä¾‹æµç¨‹å°ç…§

å‡è¨­ï¼š
```ini
nums = [1, 3, -1, -3, 5, 3, 6, 7]
k = 3
```
| i | num\[i] | dqï¼ˆå­˜ç´¢å¼•ï¼‰                                                                   | èªªæ˜                               | ç•¶ i â‰¥ kâˆ’1 æ™‚ res å¢åŠ å“ªå€‹å€¼             |
| - | ------- | ------------------------------------------------------------------------- | -------------------------------- | --------------------------------- |
| 0 | 1       | \[0]                                                                      | åŠ ç´¢å¼• 0                            | â€”                                 |
| 1 | 3       | pop å› ç‚º nums\[0]<3 â†’ `[]` â†’ append 1 â†’ \[1]                                | ç§»é™¤å°å€¼ 1 çš„ç´¢å¼•                       | â€”                                 |
| 2 | âˆ’1      | \[1,2]                                                                    | æ–°å…ƒç´  âˆ’1 æ¯”æœ«ç«¯çš„å°çš„æ²’æœ‰ â†’ append         | i=2 â‰¥2 â†’ res.append(nums\[1]) = 3 |
| 3 | âˆ’3      | \[1,2,3]                                                                  | ç§»é™¤éæœŸç´¢å¼•ï¼ŸéšŠé¦– 1 ä¸éæœŸ                  | res.append(nums\[1]) = 3          |
| 4 | 5       | pop å°¾ç«¯ âˆ’3, âˆ’1, pop 2 â†’ pop 1ï¼ˆå› ç‚º nums\[1]<5ï¼‰ â†’ then \[ ] â†’ append 4 â†’ \[4] | æ–°å…ƒç´  5 å¾ˆå¤§ï¼ŒæŠŠå¾Œé¢å°çš„éƒ½ç§»é™¤                | res.append(nums\[4]) = 5          |
| 5 | 3       | \[4,5]ï¼ˆç´¢å¼• 4,5 â†’ å€¼ 5,3ï¼‰                                                    | nums\[4]=5â‰¥3 ä¿ç•™ï¼Œappend 5 â†’\[4,5] | res.append(nums\[4]) = 5          |
| 6 | 6       | pop 5ï¼ˆnums\[5]<6ï¼‰ï¼Œpop 4ï¼ˆnums\[4]<6ï¼‰ â†’ then \[] â†’ append 6 â†’ \[6]          | æ–°å…ƒç´  6 æŠŠå‰é¢å°çš„éƒ½è½å¾Œ                   | res.append(nums\[6]) = 6          |
| 7 | 7       | similarly â†’ \[7]                                                          | æ–°å…ƒç´  7 æ›´å¤§                         | res.append(nums\[7]) = 7          |

æœ€å¾Œ res = [3,3,5,5,6,7]

---

## â± æ™‚é–“ & ç©ºé–“è¤‡é›œåº¦åˆ†æ | Time & Space Complexity

- æ™‚é–“è¤‡é›œåº¦ (Time Complexity)ï¼šO(n)ï¼Œå› ç‚ºæ¯å€‹å…ƒç´ çš„ç´¢å¼•åªæœƒè¢« append ä¸€æ¬¡ï¼Œä¹Ÿåªæœƒè¢« popï¼ˆå¾å¾Œç«¯æˆ–å‰ç«¯ï¼‰æœ€å¤šä¸€æ¬¡ã€‚æ•´é«”æ“ä½œç‚ºç·šæ€§çš„ã€‚

- ç©ºé–“è¤‡é›œåº¦ (Space Complexity)ï¼šO(k)ï¼Œdeque æœ€å£æƒ…æ³å­˜æ”¾æœ€å¤š k å€‹ç´¢å¼•ã€‚

---

## âœï¸ æˆ‘å­¸åˆ°äº†ä»€éº¼ | What I Learned

- å–®èª¿é›™ç«¯ä½‡åˆ—ï¼ˆMonotonic Deque / Monotonic Queueï¼‰æ˜¯è™•ç†æ»‘å‹•è¦–çª—æœ€å¤§ï¼æœ€å°å•é¡Œçš„å¸¸è¦‹ä¸”é«˜æ•ˆçš„å·¥å…·ã€‚

- è¦ç¶­æŒã€Œå–®èª¿éæ¸›éšŠåˆ—ã€ï¼šæ–°çš„å…ƒç´ è‹¥æ¯”éšŠå°¾å°çš„éƒ½ pop æ‰ï¼Œå› ç‚ºé€™äº›å°çš„å…ƒç´ åœ¨æœªä¾†çª—å£ä¸­æ°¸é ä¸æœƒæˆç‚ºæœ€å¤§ã€‚

- ä½¿ç”¨ç´¢å¼•è€Œéå€¼ï¼Œå¯ä»¥çŸ¥é“å“ªäº›å…ƒç´ å·²ç¶“éæœŸï¼ˆä¸åœ¨ç•¶å‰è¦–çª—ä¸­ï¼‰ã€‚

- åœ¨é¢è©¦ä¸­è¬›é€™é¡Œæ™‚ï¼Œè¦æ¸…æ¥šäº¤ä»£ç‚ºä»€éº¼ pop å¾Œç«¯ã€ç‚ºä»€éº¼ pop å‰ç«¯ã€ä»¥åŠä»€éº¼æ™‚å€™é–‹å§‹ append åˆ°çµæœï¼ˆi >= kâ€‘1ï¼‰ã€‚