# ğŸ“˜ LeetCode 371ï¼šSum of Two Integers
ğŸ”— [é¡Œç›®é€£çµ](https://leetcode.com/problems/sum-of-two-integers/)

---

## ğŸ§® é¡Œç›® | Problem Statement

### ä¸­æ–‡ï¼š
çµ¦ä½ å…©å€‹æ•´æ•¸ a å’Œ bï¼Œä¸èƒ½ä½¿ç”¨ + æˆ– - é‹ç®—å­ï¼Œè«‹å›å‚³å®ƒå€‘çš„å’Œã€‚

### Englishï¼š
Given two integers a and b, return the sum of the two integers without using the operators + or -. 

### Examples
- Example 1:

    - Input: a = 1, b = 2
    - Output: 3

- Example 2:

    - Input: a = 2, b = 3
    - Output: 5
 
---

## ğŸ§  è§£é¡Œæ€è·¯ | Solution Idea

æˆ‘å€‘å¿…é ˆé¿é–‹ + å’Œ -ï¼Œæ‰€ä»¥åªèƒ½ç”¨ä½å…ƒæ“ä½œä¾†æ¨¡æ“¬åŠ æ³•ã€‚åœ¨äºŒé€²ä½åŠ æ³•ä¸­ï¼Œæœ‰å…©ä»¶äº‹è¦è™•ç†ï¼š

1. ä¸è€ƒæ…®é€²ä½ çš„åŠ æ³• â€” å¯ä»¥ç”¨ XOR ï¼ˆ^ï¼‰ä¾†åšï¼ša ^ b

    - å› ç‚º XOR åœ¨ä½ç›¸åŒæ™‚çµ¦ 0ï¼Œä¸åŒæ™‚çµ¦ 1ï¼Œæ­£å¥½å°æ‡‰ bit åŠ æ³•ä¸­ç›¸åŒ bit ä¸é€²ä½ã€ä¸åŒ bit çµæœç‚º 1ã€‚

2. é€²ä½ çš„éƒ¨åˆ† â€” å¯ä»¥ç”¨ AND ä¸¦å·¦ç§» 1 ä½ï¼š(a & b) << 1

    - AND æ‰¾å‡ºå“ªä¸€ä½å…©è€…éƒ½æ˜¯ 1ï¼Œé‚£åœ¨åŠ æ³•ä¸­æœƒç”¢ç”Ÿé€²ä½ï¼Œé€²ä½è¦åŠ åˆ°ä¸‹ä¸€å€‹ bitï¼Œæ‰€ä»¥å·¦ç§»ã€‚

- é‚£éº¼æ•´å€‹åŠ æ³•éç¨‹å°±è®Šæˆï¼š

    - sum_without_carry = a ^ b

    - carry = (a & b) << 1

    - ç„¶å¾Œæˆ‘å€‘è¦ æŠŠ carry åŠ åˆ° sum_without_carry ä¸Šï¼Œä½†å› ç‚ºä¸èƒ½ç”¨ +ï¼Œå°±é‡è¤‡é€™å€‹æµç¨‹ï¼šæŠŠ carry ç•¶ä½œæ–°çš„ bï¼Œè®“ a = sum_without_carryï¼Œç¹¼çºŒåš XOR + AND << 1ã€‚

    - é‡è¤‡ç›´åˆ° carry ç‚º 0 ç‚ºæ­¢ï¼Œæ­¤æ™‚ a å°±æ˜¯æœ€çµ‚çµæœã€‚

- åœ¨ Python ä¸­è¦æ³¨æ„çš„æ˜¯ï¼šPython çš„æ•´æ•¸ä¸æ˜¯å›ºå®š 32 ä½å…ƒï¼Œæœƒæœ‰ç„¡é™æ“´å±•å•é¡Œï¼›å› æ­¤å¸¸è¦‹è§£æ³•æœƒç”¨ & mask é™åˆ¶åœ¨ 32 ä½ç¯„åœå…§ï¼Œä¸¦åœ¨æœ€çµ‚è™•ç†æ­£è² è™Ÿã€‚

---

## âœ… ç¨‹å¼ç¢¼ï¼ˆPython ç¯„ä¾‹ï¼‰
```python
class Solution:
    def getSum(self, a: int, b: int) -> int:
        # ç‚ºäº†æ¨¡æ“¬ 32-bit æ•´æ•¸çš„è¡Œç‚ºï¼Œç”¨ mask é™åˆ¶
        mask = 0xFFFFFFFF
        # æœ€å¤§çš„æ­£æ•¸ 32-bit
        MAX_INT = 0x7FFFFFFF
        
        a &= mask
        b &= mask
        
        while b != 0:
            # sum ä¸è€ƒæ…®é€²ä½
            sum_no_carry = (a ^ b) & mask
            # é€²ä½éƒ¨åˆ†
            carry = ((a & b) << 1) & mask
            
            a = sum_no_carry
            b = carry
        
        # å¦‚æœ a åœ¨ 32-bit ç¯„åœå…§æ˜¯æ­£æ•¸ï¼Œå°±ç›´æ¥å›å‚³
        if a <= MAX_INT:
            return a
        else:
            # å¦å‰‡æ˜¯è² æ•¸ï¼Œè½‰å› Python çš„è² å€¼è¡¨ç¤º
            return ~((a ^ mask))
```
### ğŸ§  èƒŒæ™¯é‚è¼¯ç°¡è¿°

- åœ¨äºŒé€²ä½åŠ æ³•ä¸­ï¼š

    - a ^ b ç›¸ç•¶æ–¼ã€Œä¸è€ƒæ…®é€²ä½ã€çš„åŠ æ³•

    - (a & b) << 1 æ‰¾å‡ºã€Œé€²ä½ã€çš„éƒ¨åˆ†

- æˆ‘å€‘ä¸æ–·åœ°æŠŠã€Œä¸å«é€²ä½çš„ç¸½å’Œã€èˆ‡ã€Œé€²ä½å€¼ã€åŠ èµ·ä¾†ï¼Œç›´åˆ°é€²ä½ç‚º 0ï¼Œè¡¨ç¤ºåŠ æ³•å®Œæˆã€‚

```python
mask = 0xFFFFFFFF
```

- ç”¨ä¾†æ¨¡æ“¬ 32-bit çš„æ•´æ•¸ï¼ˆå…¨éƒ¨éƒ½æ˜¯ 1ï¼Œå…± 32 ä½ï¼‰ï¼š

    - 0xFFFFFFFF â†’ 11111111111111111111111111111111ï¼ˆäºŒé€²ä½ï¼‰

- åœ¨ Python ä¸­æ•´æ•¸ä¸æ˜¯å›ºå®šé•·åº¦ï¼Œé€™è¡Œæ˜¯ç‚ºäº†ç¢ºä¿æˆ‘å€‘çš„æ•¸åœ¨ 32-bit ç¯„åœå…§é‹ä½œã€‚
```python
MAX_INT = 0x7FFFFFFF
```

- ä»£è¡¨ 32-bit æœ‰è™Ÿæ•´æ•¸æœ€å¤§å€¼ï¼Œä¹Ÿå°±æ˜¯ 2147483647ï¼ˆé¦–ä½æ˜¯ 0 è¡¨ç¤ºæ­£è™Ÿï¼‰
```python
a &= mask
b &= mask
```

- æŠŠ a å’Œ b é™åˆ¶åœ¨ 32-bit æ•´æ•¸ç¯„åœå…§ï¼ˆåš & é‹ç®—ï¼Œç›¸ç•¶æ–¼åªå–ä½ 32 ä½ï¼‰
```python
while b != 0:
```

- å¦‚æœ b é‚„æœ‰é€²ä½å€¼ï¼Œå°±ç¹¼çºŒæ¨¡æ“¬åŠ æ³•çš„ã€Œé€²ä½åŠ ä¸Šå»ã€ã€‚
```python
sum_no_carry = (a ^ b) & mask
```

- ä½¿ç”¨ XOR æ¨¡æ“¬ã€Œä¸è€ƒæ…®é€²ä½ã€çš„åŠ æ³•ï¼ˆé€™éƒ¨åˆ†æ˜¯çµæœçš„åŸºåº•ï¼‰
```python
carry = ((a & b) << 1) & mask
```

- a & bï¼šæ‰¾å‡ºæ‰€æœ‰æœƒé€²ä½çš„ bitï¼ˆå…©å€‹éƒ½æ˜¯ 1 çš„ä½ï¼‰

- << 1ï¼šé€²ä½è¦åŠ åˆ°å·¦é‚Šçš„ä¸‹ä¸€å€‹ bit

- & maskï¼šé™åˆ¶çµæœåœ¨ 32 ä½å…ƒå…§
```python
a = sum_no_carry
b = carry
```

- å°‡åŠ ç¸½çµæœé‡æ–°ç•¶æˆæ–°çš„ a

- æŠŠé€²ä½å€¼ç•¶æˆæ–°çš„ bï¼Œç¹¼çºŒæ¨¡æ“¬ã€ŒåŠ ä¸Šé€²ä½ã€
```python
if a <= MAX_INT:
    return a
```

- å¦‚æœçµæœ a å°æ–¼ç­‰æ–¼æœ€å¤§æ­£æ•´æ•¸ï¼Œä»£è¡¨å®ƒæ˜¯æ­£æ•¸ï¼Œå¯ä»¥ç›´æ¥å›å‚³
```python
return ~((a ^ mask))
```

- è‹¥ a è¶…é MAX_INTï¼Œä»£è¡¨é€™æ˜¯ä¸€å€‹ è² æ•¸

- a ^ mask æœƒæŠŠ a çš„æ¯å€‹ bit åè½‰ï¼ˆç›¸ç•¶æ–¼ ~a ä½†æ§åˆ¶åœ¨ 32-bit å…§ï¼‰

- ~(...) æ˜¯ Python çš„è£œæ•¸è¡¨ç¤ºæ³•ï¼Œå¾—åˆ°æ­£ç¢ºçš„è² æ•´æ•¸

---

## ğŸ§ª ç¯„ä¾‹æ¼”ç®— (a = 2, b = 3)
```ini
a = 2 (10â‚‚), b = 3 (11â‚‚)
```

- ç¬¬ä¸€æ¬¡ï¼š

    - sum_no_carry = 2 ^ 3 = 1

    - carry = (2 & 3) << 1 = (10â‚‚ & 11â‚‚) << 1 = (10â‚‚) << 1 = 100â‚‚ = 4

    - ä»¤ a = 1, b = 4

- ç¬¬äºŒæ¬¡ï¼š

    - sum_no_carry = 1 ^ 4 = 5

    - carry = (1 & 4) << 1 = 0 << 1 = 0

    - b = 0ï¼Œåœæ­¢

- æœ€çµ‚ a = 5ï¼Œç­”æ¡ˆæ˜¯ 5ã€‚

---

## â± è¤‡é›œåº¦åˆ†æ | Complexity

- æ™‚é–“è¤‡é›œåº¦ï¼šO(1)
    - é›–ç„¶ç”¨ while è¿´åœˆï¼Œä½†åœ¨ 32-bit çš„æƒ…æ³ä¸‹ï¼Œæœ€å¤šåš 32 æ¬¡é‹ç®—ï¼Œæ‰€ä»¥å¯ä»¥è¦–ç‚ºå¸¸æ•¸æ™‚é–“ã€‚ 

- ç©ºé–“è¤‡é›œåº¦ï¼šO(1)
    - åªç”¨åˆ°å°‘æ•¸å¸¸æ•¸è®Šæ•¸ã€‚

---

## ğŸ§  æˆ‘å­¸åˆ°ä»€éº¼ / What I Learned

- ä½å…ƒåŠ æ³•å¯ä»¥è¢«æ‹†è§£æˆ XORï¼ˆä¸å«é€²ä½ï¼‰èˆ‡ ANDï¼ˆé€²ä½ï¼‰å…©éƒ¨åˆ†ã€‚

- é‡è¤‡è¨ˆç®—ç›´åˆ°æ²’æœ‰é€²ä½ï¼Œå°±å®Œæˆäº†æ•´æ•¸ç›¸åŠ ã€‚

- åœ¨ Python ä¸­è¦æ³¨æ„æ•´æ•¸ç„¡é™ä½çš„ç‰¹æ€§ï¼Œå› æ­¤è¦ç”¨ mask ä¾†æ¨¡æ“¬å›ºå®š 32-bit è¡Œç‚ºã€‚